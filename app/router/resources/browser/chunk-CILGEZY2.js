import{P as u,a as n,d as l,j as g}from"./chunk-AMPHMTWR.js";var h=(()=>{class s{constructor(){this.settingsSubject=new g(this.getDefaultSettings()),this.settings$=this.settingsSubject.asObservable(),this.STORAGE_KEY="app-settings",this.loadSettings()}getDefaultSettings(){return{favicon:null,banner:null,userAvatar:null,companyName:"Omnishore",appTitle:"Order App"}}loadSettings(){if(this.isBrowser()){let t=localStorage.getItem(this.STORAGE_KEY);if(t)try{let e=JSON.parse(t);this.settingsSubject.next(n(n({},this.getDefaultSettings()),e))}catch(e){console.error("Failed to load settings:",e)}}}saveSettings(t){this.isBrowser()&&localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}getCurrentSettings(){return this.settingsSubject.value}updateSettings(t){let e=this.getCurrentSettings(),r=n(n({},e),t);this.settingsSubject.next(r),this.saveSettings(r)}uploadFile(t,e){return l(this,null,function*(){return new Promise((r,i)=>{if(!this.isValidImageFile(t)){i(new Error("Please select a valid image file (PNG, JPG, JPEG, GIF, SVG)"));return}if(t.size>5*1024*1024){i(new Error("File size must be less than 5MB"));return}if(e==="favicon"&&t.size>1024*1024){i(new Error("Favicon size must be less than 1MB"));return}let a=new FileReader;a.onload=c=>{let o=c.target?.result;o?(this.updateSettings({[e]:o}),r(o)):i(new Error("Failed to read file"))},a.onerror=()=>i(new Error("Failed to read file")),a.readAsDataURL(t)})})}isValidImageFile(t){return["image/png","image/jpeg","image/jpg","image/gif","image/svg+xml"].includes(t.type)}removeFile(t){this.updateSettings({[t]:null})}resetToDefaults(){let t=this.getDefaultSettings();this.settingsSubject.next(t),this.saveSettings(t)}getFaviconUrl(){return this.getCurrentSettings().favicon||null}getBannerUrl(){return this.getCurrentSettings().banner||null}getUserAvatarUrl(){return this.getCurrentSettings().userAvatar||null}updateFavicon(){if(this.isBrowser()){let t=this.getFaviconUrl(),e=document.querySelector('link[rel="icon"]');e&&t&&(e.href=t)}}isBrowser(){return typeof window<"u"&&typeof localStorage<"u"}static{this.\u0275fac=function(e){return new(e||s)}}static{this.\u0275prov=u({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{h as a};

import{P as d,d as l,j as a}from"./chunk-ZITZSLP4.js";var c={production:!0,developmentMode:!1,apiUrl:"/api",enableMockAuth:!1};var O=(()=>{class i{constructor(){this.userSubject=new a(null),this.user$=this.userSubject.asObservable(),this.isAuthenticatedSubject=new a(!1),this.isAuthenticated$=this.isAuthenticatedSubject.asObservable(),this.isLocalDevelopment=this.checkLocalDevelopment(),this.loadUserInfo()}checkLocalDevelopment(){if(c.enableMockAuth!==void 0)return c.enableMockAuth;if(!this.isBrowser())return!1;let t=window.location.hostname,e=window.location.port;return t==="localhost"||t==="127.0.0.1"||t==="0.0.0.0"||e==="4200"||e==="3000"||t.includes("localhost")}loadUserInfo(){return l(this,null,function*(){try{let e=yield fetch("/user-api/currentUser",{credentials:"include",headers:{Accept:"application/json"}});if(e.ok){let r=yield e.json(),n=r.firstname||"",o=r.lastname||"",u=n&&o?`${n} ${o}`:r.displayName||r.name||"Authenticated User",h=n&&o?`${n.charAt(0).toUpperCase()}${o.charAt(0).toUpperCase()}`:u.split(" ").map(s=>s.charAt(0)).join("").toUpperCase().substring(0,2),m=r.scopes?r.scopes.filter(s=>s.includes("OrderCreator")||s.includes("OrderViewer")||s.includes("Admin")).map(s=>s.includes("OrderCreator")?"OrderCreator":s.includes("OrderViewer")?"OrderViewer":s.includes("Admin")?"Administrator":s):["OrderViewer"],p={id:r.name||r.email||"authenticated-user",name:u,email:r.email||"user@company.com",initials:h,scopes:r.scopes||["OrderViewer"],roles:m};this.userSubject.next(p),this.isAuthenticatedSubject.next(!0);return}}catch{}let t={id:"authenticated-user",name:"Authenticated User",email:"user@company.com",initials:"AU",scopes:["OrderCreator","OrderViewer","Admin"],roles:["Administrator","OrderCreator","OrderViewer"]};this.userSubject.next(t),this.isAuthenticatedSubject.next(!0)})}handleAuthError(){console.log("\u{1F510} App router handles authentication - no error handling needed")}getCurrentUser(){return this.userSubject.value}isAuthenticated(){return this.isAuthenticatedSubject.value}hasScope(t){let e=this.getCurrentUser();return e?e.scopes.includes(t):!1}hasRole(t){let e=this.getCurrentUser();return e?e.roles.includes(t):!1}canCreateOrders(){return this.hasScope("OrderCreator")||this.hasRole("OrderCreator")||this.hasRole("Administrator")}canViewOrders(){return this.hasScope("OrderViewer")||this.hasRole("OrderViewer")||this.hasRole("OrderCreator")||this.hasRole("Administrator")}isAdmin(){return this.hasScope("Admin")||this.hasRole("Administrator")}logout(){if(this.isLocalDevelopment){console.log("\u{1F513} Development mode - Logout disabled");return}this.isBrowser()&&(window.location.href="/do/logout")}isLocalDevelopmentMode(){return this.isLocalDevelopment}isBrowser(){return typeof window<"u"}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275prov=d({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{O as a};
